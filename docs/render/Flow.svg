<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="8975px" preserveAspectRatio="none" style="width:2878px;height:8975px;background:#FFFFFF;" version="1.1" viewBox="0 0 2878 8975" width="2878.125px" zoomAndPan="magnify"><defs/><g><rect fill="transparent" height="1992.8955" style="stroke:#000000;stroke-width:4.6875;" width="2025.6485" x="231.25" y="735.083"/><rect fill="transparent" height="804.1504" style="stroke:#000000;stroke-width:4.6875;" width="1934.8816" x="262.5" y="810.498"/><rect fill="transparent" height="687.2803" style="stroke:#000000;stroke-width:4.6875;" width="1963.1485" x="262.5" y="2018.8232"/><rect fill="transparent" height="241.8701" style="stroke:#000000;stroke-width:4.6875;" width="1817.5278" x="1009.8389" y="3129.2236"/><rect fill="transparent" height="781.8604" style="stroke:#000000;stroke-width:4.6875;" width="1817.5278" x="1009.8389" y="3414.8438"/><g><title>Admin</title><rect fill="transparent" height="7514.6729" width="25" x="373.2254" y="113.4277"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="384.375" x2="384.375" y1="113.4277" y2="7628.1006"/></g><line style="stroke:#A80036;stroke-width:3.125;stroke-dasharray:1.0,4.0;" x1="384.375" x2="384.375" y1="7628.1006" y2="7755.6152"/><g><title>Admin</title><rect fill="transparent" height="1110.1074" width="25" x="373.2254" y="7755.6152"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="384.375" x2="384.375" y1="7755.6152" y2="8865.7227"/></g><g><title>Client</title><rect fill="transparent" height="7514.6729" width="25" x="1113.7924" y="113.4277"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="1125.4639" x2="1125.4639" y1="113.4277" y2="7628.1006"/></g><line style="stroke:#A80036;stroke-width:3.125;stroke-dasharray:1.0,4.0;" x1="1125.4639" x2="1125.4639" y1="7628.1006" y2="7755.6152"/><g><title>Client</title><rect fill="transparent" height="1110.1074" width="25" x="1113.7924" y="7755.6152"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="1125.4639" x2="1125.4639" y1="7755.6152" y2="8865.7227"/></g><g><title>Server</title><rect fill="transparent" height="7514.6729" width="25" x="1717.9443" y="113.4277"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="1727.4597" x2="1727.4597" y1="113.4277" y2="7628.1006"/></g><line style="stroke:#A80036;stroke-width:3.125;stroke-dasharray:1.0,4.0;" x1="1727.4597" x2="1727.4597" y1="7628.1006" y2="7755.6152"/><g><title>Server</title><rect fill="transparent" height="1110.1074" width="25" x="1717.9443" y="7755.6152"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="1727.4597" x2="1727.4597" y1="7755.6152" y2="8865.7227"/></g><g><title>IPFS</title><rect fill="transparent" height="7514.6729" width="25" x="2233.5938" y="113.4277"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="2243.7332" x2="2243.7332" y1="113.4277" y2="7628.1006"/></g><line style="stroke:#A80036;stroke-width:3.125;stroke-dasharray:1.0,4.0;" x1="2243.7332" x2="2243.7332" y1="7628.1006" y2="7755.6152"/><g><title>IPFS</title><rect fill="transparent" height="1110.1074" width="25" x="2233.5938" y="7755.6152"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="2243.7332" x2="2243.7332" y1="7755.6152" y2="8865.7227"/></g><g><title>Smart Contract</title><rect fill="transparent" height="7514.6729" width="25" x="2594.5175" y="113.4277"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="2605.4184" x2="2605.4184" y1="113.4277" y2="7628.1006"/></g><line style="stroke:#A80036;stroke-width:3.125;stroke-dasharray:1.0,4.0;" x1="2605.4184" x2="2605.4184" y1="7628.1006" y2="7755.6152"/><g><title>Smart Contract</title><rect fill="transparent" height="1110.1074" width="25" x="2594.5175" y="7755.6152"/><line style="stroke:#181818;stroke-width:1.5625;stroke-dasharray:5.0,5.0;" x1="2605.4184" x2="2605.4184" y1="7755.6152" y2="8865.7227"/></g><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="183.9508" x="293.75" y="15.625"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="140.2008" x="315.625" y="78.1097">Admin</text><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="183.9508" x="293.75" y="8862.5977"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="140.2008" x="315.625" y="8925.0824">Admin</text><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="170.4071" x="1041.0889" y="15.625"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="126.6571" x="1062.9639" y="78.1097">Client</text><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="170.4071" x="1041.0889" y="8862.5977"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="126.6571" x="1062.9639" y="8925.0824">Client</text><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="187.2192" x="1636.8347" y="15.625"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="143.4692" x="1658.7097" y="78.1097">Server</text><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="187.2192" x="1636.8347" y="8862.5977"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="143.4692" x="1658.7097" y="8925.0824">Server</text><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="135.9711" x="2178.1082" y="15.625"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="92.2211" x="2199.9832" y="78.1097">IPFS</text><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="135.9711" x="2178.1082" y="8862.5977"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="92.2211" x="2199.9832" y="8925.0824">IPFS</text><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="378.1982" x="2417.9184" y="15.625"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="334.4482" x="2439.7934" y="78.1097">Smart Contract</text><rect fill="#E2E2F0" height="94.6777" rx="7.8125" ry="7.8125" style="stroke:#181818;stroke-width:1.5625;" width="378.1982" x="2417.9184" y="8862.5977"/><text fill="#000000" font-family="sans-serif" font-size="43.75" lengthAdjust="spacing" textLength="334.4482" x="2439.7934" y="8925.0824">Smart Contract</text><rect fill="#EEEEEE" height="9.375" style="stroke:#EEEEEE;stroke-width:3.125;" width="2858.6166" x="0" y="208.9478"/><line style="stroke:#000000;stroke-width:3.125;" x1="0" x2="2858.6166" y1="208.9478" y2="208.9478"/><line style="stroke:#000000;stroke-width:3.125;" x1="0" x2="2858.6166" y1="218.3228" y2="218.3228"/><rect fill="#EEEEEE" height="72.29" style="stroke:#000000;stroke-width:6.25;" width="546.5439" x="1156.0364" y="175.9277"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="488.6505" x="1174.7864" y="226.1368">Setup software steps</text><path d="M15.625,295.0928 L15.625,513.8428 L1496.875,513.8428 L1496.875,326.3428 L1465.625,295.0928 L15.625,295.0928 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M1465.625,295.0928 L1465.625,326.3428 L1496.875,326.3428 L1465.625,295.0928 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1356.6528" x="34.375" y="348.4268">When admin installs software on client and server it sets by config</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1112.1094" x="34.375" y="395.7169">its own public key. Also it sets smart contract address.</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="12.9135" x="34.375" y="443.0069">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1418.2846" x="34.375" y="490.2969">So software can trust particular smart contract and admin public key.</text><polygon fill="#181818" points="1088.7924,584.668,1120.0424,597.168,1088.7924,609.668,1101.2924,597.168" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="1107.5424" y1="597.168" y2="597.168"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="28.2669" x="407.6004" y="581.337">1</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="418.5883" x="448.3673" y="581.337">Install DPKI software</text><polygon fill="#181818" points="1692.9443,675.708,1724.1943,688.208,1692.9443,700.708,1705.4443,688.208" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="1711.6943" y1="688.208" y2="688.208"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="28.2669" x="407.6004" y="672.377">2</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="418.5883" x="448.3673" y="672.377">Install DPKI software</text><path d="M231.25,735.083 L432.634,735.083 L432.634,757.373 L401.384,788.623 L231.25,788.623 L231.25,735.083 " fill="#EEEEEE" style="stroke:#000000;stroke-width:4.6875;"/><rect fill="transparent" height="1992.8955" style="stroke:#000000;stroke-width:4.6875;" width="2025.6485" x="231.25" y="735.083"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="60.759" x="278.125" y="775.9171">alt</text><text fill="#000000" font-family="sans-serif" font-size="34.375" font-weight="bold" lengthAdjust="spacing" textLength="241.8671" x="479.509" y="773.2407">[Auto mode]</text><path d="M262.5,810.498 L479.6539,810.498 L479.6539,832.7881 L448.4039,864.0381 L262.5,864.0381 L262.5,810.498 " fill="#EEEEEE" style="stroke:#000000;stroke-width:4.6875;"/><rect fill="transparent" height="804.1504" style="stroke:#000000;stroke-width:4.6875;" width="1934.8816" x="262.5" y="810.498"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="76.5289" x="309.375" y="851.3321">par</text><path d="M712.5,879.6631 L712.5,1145.2881 L2140.625,1145.2881 L2140.625,910.9131 L2109.375,879.6631 L712.5,879.6631 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M2109.375,879.6631 L2109.375,910.9131 L2140.625,910.9131 L2109.375,879.6631 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="972.1832" x="731.25" y="932.9971">This generated key pair is not related with SSH.</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1362.5641" x="731.25" y="980.2872">We need it to work with smart contract and to interact with admin.</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1109.5703" x="731.25" y="1027.5772">That's key pair is more sensentive than SSH key pairs.</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1264.6118" x="731.25" y="1074.8672">That's why generation should be processed automatically and</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="559.288" x="731.25" y="1122.1573">should  never leave device.</text><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="1257.5424" y1="1229.0283" y2="1229.0283"/><line style="stroke:#181818;stroke-width:3.125;" x1="1257.5424" x2="1257.5424" y1="1229.0283" y2="1269.6533"/><line style="stroke:#181818;stroke-width:3.125;" x1="1129.4174" x2="1257.5424" y1="1269.6533" y2="1269.6533"/><polygon fill="#181818" points="1160.6674,1257.1533,1129.4174,1269.6533,1160.6674,1282.1533,1148.1674,1269.6533" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="28.2669" x="1148.1674" y="1213.1973">3</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="366.7953" x="1188.9343" y="1213.1973">Generate key pair</text><polygon fill="#181818" points="420.1004,1348.1934,388.8504,1360.6934,420.1004,1373.1934,407.6004,1360.6934" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="401.3504" x2="1123.1674" y1="1360.6934" y2="1360.6934"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="28.2669" x="438.8504" y="1344.8624">4</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="322.937" x="479.6173" y="1344.8624">Send public key</text><line style="stroke:#000000;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="262.5" x2="2197.3816" y1="1388.8184" y2="1388.8184"/><line style="stroke:#181818;stroke-width:3.125;" x1="1730.4443" x2="1861.6943" y1="1457.9834" y2="1457.9834"/><line style="stroke:#181818;stroke-width:3.125;" x1="1861.6943" x2="1861.6943" y1="1457.9834" y2="1498.6084"/><line style="stroke:#181818;stroke-width:3.125;" x1="1733.5693" x2="1861.6943" y1="1498.6084" y2="1498.6084"/><polygon fill="#181818" points="1764.8193,1486.1084,1733.5693,1498.6084,1764.8193,1511.1084,1752.3193,1498.6084" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="28.2669" x="1752.3193" y="1442.1524">5</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="366.7953" x="1793.0862" y="1442.1524">Generate key pair</text><polygon fill="#181818" points="420.1004,1577.1484,388.8504,1589.6484,420.1004,1602.1484,407.6004,1589.6484" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="401.3504" x2="1727.3193" y1="1589.6484" y2="1589.6484"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="28.2669" x="438.8504" y="1573.8174">6</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="322.937" x="479.6173" y="1573.8174">Send public key</text><path d="M300,1652.1484 L300,1777.1484 L1812.5,1777.1484 L1812.5,1683.3984 L1781.25,1652.1484 L300,1652.1484 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M1781.25,1652.1484 L1781.25,1683.3984 L1812.5,1683.3984 L1781.25,1652.1484 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="741.5848" x="672.4846" y="1705.4825">So admin knows devices public keys</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="737.9547" x="672.4846" y="1752.7725">and devices know admin public key.</text><line style="stroke:#000000;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="231.25" x2="2256.8985" y1="1796.7285" y2="1796.7285"/><text fill="#000000" font-family="sans-serif" font-size="34.375" font-weight="bold" lengthAdjust="spacing" textLength="292.07" x="246.875" y="1828.6362">[Manual mode]</text><path d="M1015.625,1855.4932 L1015.625,1980.4932 L1840.625,1980.4932 L1840.625,1886.7432 L1809.375,1855.4932 L1015.625,1855.4932 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M1809.375,1855.4932 L1809.375,1886.7432 L1840.625,1886.7432 L1809.375,1855.4932 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="757.4142" x="1034.375" y="1908.8272">In this case admin can get public key</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="759.7748" x="1034.375" y="1956.1172">from device on installation or after it.</text><path d="M262.5,2018.8232 L479.6539,2018.8232 L479.6539,2041.1133 L448.4039,2072.3633 L262.5,2072.3633 L262.5,2018.8232 " fill="#EEEEEE" style="stroke:#000000;stroke-width:4.6875;"/><rect fill="transparent" height="687.2803" style="stroke:#000000;stroke-width:4.6875;" width="1963.1485" x="262.5" y="2018.8232"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="76.5289" x="309.375" y="2059.6573">par</text><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="1257.5424" y1="2138.4033" y2="2138.4033"/><line style="stroke:#181818;stroke-width:3.125;" x1="1257.5424" x2="1257.5424" y1="2138.4033" y2="2179.0283"/><line style="stroke:#181818;stroke-width:3.125;" x1="1129.4174" x2="1257.5424" y1="2179.0283" y2="2179.0283"/><polygon fill="#181818" points="1160.6674,2166.5283,1129.4174,2179.0283,1160.6674,2191.5283,1148.1674,2179.0283" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="28.2669" x="1148.1674" y="2122.5723">7</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="366.7953" x="1188.9343" y="2122.5723">Generate key pair</text><polygon fill="#181818" points="1088.7924,2257.5684,1120.0424,2270.0684,1088.7924,2282.5684,1101.2924,2270.0684" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="1107.5424" y1="2270.0684" y2="2270.0684"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="28.2669" x="407.6004" y="2254.2374">8</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="547.7234" x="448.3673" y="2254.2374">Get public key from device</text><polygon fill="#181818" points="420.1004,2348.6084,388.8504,2361.1084,420.1004,2373.6084,407.6004,2361.1084" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="401.3504" x2="1123.1674" y1="2361.1084" y2="2361.1084"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="28.2669" x="438.8504" y="2345.2774">9</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="206.4178" x="479.6173" y="2345.2774">Public key</text><line style="stroke:#000000;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="262.5" x2="2225.6485" y1="2389.2334" y2="2389.2334"/><line style="stroke:#181818;stroke-width:3.125;" x1="1730.4443" x2="1861.6943" y1="2458.3984" y2="2458.3984"/><line style="stroke:#181818;stroke-width:3.125;" x1="1861.6943" x2="1861.6943" y1="2458.3984" y2="2499.0234"/><line style="stroke:#181818;stroke-width:3.125;" x1="1733.5693" x2="1861.6943" y1="2499.0234" y2="2499.0234"/><polygon fill="#181818" points="1764.8193,2486.5234,1733.5693,2499.0234,1764.8193,2511.5234,1752.3193,2499.0234" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1752.3193" y="2442.5674">10</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="366.7953" x="1821.3531" y="2442.5674">Generate key pair</text><polygon fill="#181818" points="1692.9443,2577.5635,1724.1943,2590.0635,1692.9443,2602.5635,1705.4443,2590.0635" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="1711.6943" y1="2590.0635" y2="2590.0635"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="2574.2325">11</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="547.7234" x="476.6342" y="2574.2325">Get public key from device</text><polygon fill="#181818" points="420.1004,2668.6035,388.8504,2681.1035,420.1004,2693.6035,407.6004,2681.1035" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="401.3504" x2="1727.3193" y1="2681.1035" y2="2681.1035"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="438.8504" y="2665.2725">12</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="206.4178" x="507.8842" y="2665.2725">Public key</text><rect fill="#EEEEEE" height="9.375" style="stroke:#EEEEEE;stroke-width:3.125;" width="2858.6166" x="0" y="2814.1235"/><line style="stroke:#000000;stroke-width:3.125;" x1="0" x2="2858.6166" y1="2814.1235" y2="2814.1235"/><line style="stroke:#000000;stroke-width:3.125;" x1="0" x2="2858.6166" y1="2823.4985" y2="2823.4985"/><rect fill="#EEEEEE" height="72.29" style="stroke:#000000;stroke-width:6.25;" width="613.0157" x="1122.8004" y="2781.1035"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="555.1224" x="1141.5504" y="2831.3126">Broadcast CA certificate</text><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="516.9754" y1="2950.6836" y2="2950.6836"/><line style="stroke:#181818;stroke-width:3.125;" x1="516.9754" x2="516.9754" y1="2950.6836" y2="2991.3086"/><line style="stroke:#181818;stroke-width:3.125;" x1="388.8504" x2="516.9754" y1="2991.3086" y2="2991.3086"/><polygon fill="#181818" points="420.1004,2978.8086,388.8504,2991.3086,420.1004,3003.8086,407.6004,2991.3086" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="2934.8526">13</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="627.7832" x="476.6342" y="2934.8526">Generate new SSH CA key pair</text><polygon fill="#181818" points="2569.5175,3069.8486,2600.7675,3082.3486,2569.5175,3094.8486,2582.0175,3082.3486" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="2588.2675" y1="3082.3486" y2="3082.3486"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="3066.5176">14</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="581.3263" x="476.6342" y="3066.5176">Save new SSH CA public key</text><path d="M1009.8389,3129.2236 L1226.9928,3129.2236 L1226.9928,3151.5137 L1195.7428,3182.7637 L1009.8389,3182.7637 L1009.8389,3129.2236 " fill="#EEEEEE" style="stroke:#000000;stroke-width:4.6875;"/><rect fill="transparent" height="241.8701" style="stroke:#000000;stroke-width:4.6875;" width="1817.5278" x="1009.8389" y="3129.2236"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="76.5289" x="1056.7139" y="3170.0577">par</text><polygon fill="#181818" points="1160.6674,3236.3037,1129.4174,3248.8037,1160.6674,3261.3037,1148.1674,3248.8037" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="1141.9174" x2="2603.8925" y1="3248.8037" y2="3248.8037"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1179.4174" y="3232.9727">15</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="732.5394" x="1248.4512" y="3232.9727">Notify about new SSH CA public key</text><line style="stroke:#000000;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="1009.8389" x2="2827.3666" y1="3276.9287" y2="3276.9287"/><polygon fill="#181818" points="1764.8193,3333.5938,1733.5693,3346.0938,1764.8193,3358.5938,1752.3193,3346.0938" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="1746.0693" x2="2603.8925" y1="3346.0938" y2="3346.0938"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1783.5693" y="3330.2628">16</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="732.5394" x="1852.6031" y="3330.2628">Notify about new SSH CA public key</text><path d="M1009.8389,3414.8438 L1226.9928,3414.8438 L1226.9928,3437.1338 L1195.7428,3468.3838 L1009.8389,3468.3838 L1009.8389,3414.8438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:4.6875;"/><rect fill="transparent" height="781.8604" style="stroke:#000000;stroke-width:4.6875;" width="1817.5278" x="1009.8389" y="3414.8438"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="76.5289" x="1056.7139" y="3455.6778">par</text><polygon fill="#181818" points="2569.5175,3521.9238,2600.7675,3534.4238,2569.5175,3546.9238,2582.0175,3534.4238" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="2588.2675" y1="3534.4238" y2="3534.4238"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1148.1674" y="3518.5928">17</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="554.0115" x="1217.2012" y="3518.5928">Get new SSH CA public key</text><polygon fill="#181818" points="1160.6674,3612.9639,1129.4174,3625.4639,1160.6674,3637.9639,1148.1674,3625.4639" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="1141.9174" x2="2603.8925" y1="3625.4639" y2="3625.4639"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1179.4174" y="3609.6329">18</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="618.956" x="1248.4512" y="3609.6329">Return new SSH CA public key</text><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="1257.5424" y1="3763.7939" y2="3763.7939"/><line style="stroke:#181818;stroke-width:3.125;" x1="1257.5424" x2="1257.5424" y1="3763.7939" y2="3804.4189"/><line style="stroke:#181818;stroke-width:3.125;" x1="1129.4174" x2="1257.5424" y1="3804.4189" y2="3804.4189"/><polygon fill="#181818" points="1160.6674,3791.9189,1129.4174,3804.4189,1160.6674,3816.9189,1148.1674,3804.4189" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1148.1674" y="3724.3179">19</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="375.6821" x="1217.2012" y="3700.6729">Apply new SSH CA</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="359.9915" x="1230.1147" y="3747.963">with SSH daemon</text><line style="stroke:#000000;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="1009.8389" x2="2827.3666" y1="3832.5439" y2="3832.5439"/><polygon fill="#181818" points="2569.5175,3889.209,2600.7675,3901.709,2569.5175,3914.209,2582.0175,3901.709" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="1730.4443" x2="2588.2675" y1="3901.709" y2="3901.709"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1752.3193" y="3885.878">20</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="554.0115" x="1821.3531" y="3885.878">Get new SSH CA public key</text><polygon fill="#181818" points="1764.8193,3980.249,1733.5693,3992.749,1764.8193,4005.249,1752.3193,3992.749" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="1746.0693" x2="2603.8925" y1="3992.749" y2="3992.749"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1783.5693" y="3976.918">21</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="618.956" x="1852.6031" y="3976.918">Return new SSH CA public key</text><line style="stroke:#181818;stroke-width:3.125;" x1="1730.4443" x2="1861.6943" y1="4131.0791" y2="4131.0791"/><line style="stroke:#181818;stroke-width:3.125;" x1="1861.6943" x2="1861.6943" y1="4131.0791" y2="4171.7041"/><line style="stroke:#181818;stroke-width:3.125;" x1="1733.5693" x2="1861.6943" y1="4171.7041" y2="4171.7041"/><polygon fill="#181818" points="1764.8193,4159.2041,1733.5693,4171.7041,1764.8193,4184.2041,1752.3193,4171.7041" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1752.3193" y="4091.6031">22</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="375.6821" x="1821.3531" y="4067.9581">Apply new SSH CA</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="359.9915" x="1834.2667" y="4115.2481">with SSH daemon</text><rect fill="#EEEEEE" height="9.375" style="stroke:#EEEEEE;stroke-width:3.125;" width="2858.6166" x="0" y="4282.8491"/><line style="stroke:#000000;stroke-width:3.125;" x1="0" x2="2858.6166" y1="4282.8491" y2="4282.8491"/><line style="stroke:#000000;stroke-width:3.125;" x1="0" x2="2858.6166" y1="4292.2241" y2="4292.2241"/><rect fill="#EEEEEE" height="72.29" style="stroke:#000000;stroke-width:6.25;" width="848.0972" x="1005.2597" y="4249.8291"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="790.2039" x="1024.0097" y="4300.0381">Broadcast new SSH keys by admin</text><path d="M300,4368.9941 L300,4493.9941 L1812.5,4493.9941 L1812.5,4400.2441 L1781.25,4368.9941 L300,4368.9941 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M1781.25,4368.9941 L1781.25,4400.2441 L1812.5,4400.2441 L1781.25,4368.9941 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="928.8406" x="578.8567" y="4422.3282">In this group we have an example with client,</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="794.8853" x="578.8567" y="4469.6182">but for server same steps should work.</text><path d="M300,4526.0742 L300,4604.1992 L1812.5,4604.1992 L1812.5,4557.3242 L1781.25,4526.0742 L300,4526.0742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M1781.25,4526.0742 L1781.25,4557.3242 L1812.5,4557.3242 L1781.25,4526.0742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1126.4511" x="480.0514" y="4579.4083">Also before these steps admin should prepare CA keys.</text><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="516.9754" y1="4686.2793" y2="4686.2793"/><line style="stroke:#181818;stroke-width:3.125;" x1="516.9754" x2="516.9754" y1="4686.2793" y2="4726.9043"/><line style="stroke:#181818;stroke-width:3.125;" x1="388.8504" x2="516.9754" y1="4726.9043" y2="4726.9043"/><polygon fill="#181818" points="420.1004,4714.4043,388.8504,4726.9043,420.1004,4739.4043,407.6004,4726.9043" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="4670.4483">23</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="558.7128" x="476.6342" y="4670.4483">Generate new SSH key pair</text><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="516.9754" y1="4865.2344" y2="4865.2344"/><line style="stroke:#181818;stroke-width:3.125;" x1="516.9754" x2="516.9754" y1="4865.2344" y2="4905.8594"/><line style="stroke:#181818;stroke-width:3.125;" x1="388.8504" x2="516.9754" y1="4905.8594" y2="4905.8594"/><polygon fill="#181818" points="420.1004,4893.3594,388.8504,4905.8594,420.1004,4918.3594,407.6004,4905.8594" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="4825.7584">24</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="443.5623" x="476.6342" y="4802.1133">Sign newly generated</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="494.4626" x="489.5477" y="4849.4034">public key using SSH CA</text><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="516.9754" y1="5044.1895" y2="5044.1895"/><line style="stroke:#181818;stroke-width:3.125;" x1="516.9754" x2="516.9754" y1="5044.1895" y2="5084.8145"/><line style="stroke:#181818;stroke-width:3.125;" x1="388.8504" x2="516.9754" y1="5084.8145" y2="5084.8145"/><polygon fill="#181818" points="420.1004,5072.3145,388.8504,5084.8145,420.1004,5097.3145,407.6004,5084.8145" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="5004.7134">25</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="352.2751" x="476.6342" y="4981.0684">Calculate hash of</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="519.0994" x="489.5477" y="5028.3585">newly generated key pair</text><path d="M300,5125.4395 L300,5297.3145 L1812.5,5297.3145 L1812.5,5156.6895 L1781.25,5125.4395 L300,5125.4395 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M1781.25,5125.4395 L1781.25,5156.6895 L1812.5,5156.6895 L1781.25,5125.4395 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="881.6696" x="388.9725" y="5178.7735">Admin knows client and server public keys.</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1308.609" x="388.9725" y="5226.0635">So admin can generate shared secret keys for client and server.</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="726.9257" x="388.9725" y="5273.3536">Using Diffie-Hellman key exchange.</text><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="516.9754" y1="5427.5146" y2="5427.5146"/><line style="stroke:#181818;stroke-width:3.125;" x1="516.9754" x2="516.9754" y1="5427.5146" y2="5468.1396"/><line style="stroke:#181818;stroke-width:3.125;" x1="388.8504" x2="516.9754" y1="5468.1396" y2="5468.1396"/><polygon fill="#181818" points="420.1004,5455.6396,388.8504,5468.1396,420.1004,5480.6396,407.6004,5468.1396" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="5388.0386">26</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="480.9738" x="476.6342" y="5364.3936">Generate shared secret</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="454.8492" x="489.5477" y="5411.6837">using client public key</text><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="516.9754" y1="5606.4697" y2="5606.4697"/><line style="stroke:#181818;stroke-width:3.125;" x1="516.9754" x2="516.9754" y1="5606.4697" y2="5647.0947"/><line style="stroke:#181818;stroke-width:3.125;" x1="388.8504" x2="516.9754" y1="5647.0947" y2="5647.0947"/><polygon fill="#181818" points="420.1004,5634.5947,388.8504,5647.0947,420.1004,5659.5947,407.6004,5647.0947" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="5566.9937">27</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="456.9717" x="476.6342" y="5543.3487">Encrypt newly created</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="259.1827" x="489.5477" y="5590.6387">SSH key pair</text><polygon fill="#181818" points="2208.5938,5725.6348,2239.8438,5738.1348,2208.5938,5750.6348,2221.0938,5738.1348" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="2227.3438" y1="5738.1348" y2="5738.1348"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="5722.3038">28</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="557.5027" x="476.6342" y="5722.3038">Put encrypted SSH key pair</text><path d="M1118.75,5778.7598 L1118.75,5856.8848 L2228.125,5856.8848 L2228.125,5810.0098 L2196.875,5778.7598 L1118.75,5778.7598 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M2196.875,5778.7598 L2196.875,5810.0098 L2228.125,5810.0098 L2196.875,5778.7598 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1044.8639" x="1137.5" y="5832.0938">https://docs.ipfs.tech/concepts/content-addressing/</text><polygon fill="#181818" points="420.1004,5926.4648,388.8504,5938.9648,420.1004,5951.4648,407.6004,5938.9648" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="401.3504" x2="2242.9688" y1="5938.9648" y2="5938.9648"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="438.8504" y="5923.1339">29</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="478.5339" x="507.8842" y="5923.1339">Return unique data CID</text><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="516.9754" y1="6077.2949" y2="6077.2949"/><line style="stroke:#181818;stroke-width:3.125;" x1="516.9754" x2="516.9754" y1="6077.2949" y2="6117.9199"/><line style="stroke:#181818;stroke-width:3.125;" x1="388.8504" x2="516.9754" y1="6117.9199" y2="6117.9199"/><polygon fill="#181818" points="420.1004,6105.4199,388.8504,6117.9199,420.1004,6130.4199,407.6004,6117.9199" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="6037.8189">30</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="240.7547" x="476.6342" y="6014.1739">Encrypt CID</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="400.9735" x="489.5477" y="6061.4639">using shared secret</text><polygon fill="#181818" points="2569.5175,6196.46,2600.7675,6208.96,2569.5175,6221.46,2582.0175,6208.96" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="2588.2675" y1="6208.96" y2="6208.96"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="6193.129">31</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="1156.6422" x="476.6342" y="6193.129">Save to smart contract encrypted CID with key pair hash</text><polygon fill="#181818" points="1160.6674,6287.5,1129.4174,6300,1160.6674,6312.5,1148.1674,6300" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="1141.9174" x2="2603.8925" y1="6300" y2="6300"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1179.4174" y="6284.169">32</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="978.2333" x="1248.4512" y="6284.169">Notify client about new SSH key pair availability</text><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="1257.5424" y1="6438.3301" y2="6438.3301"/><line style="stroke:#181818;stroke-width:3.125;" x1="1257.5424" x2="1257.5424" y1="6438.3301" y2="6478.9551"/><line style="stroke:#181818;stroke-width:3.125;" x1="1129.4174" x2="1257.5424" y1="6478.9551" y2="6478.9551"/><polygon fill="#181818" points="1160.6674,6466.4551,1129.4174,6478.9551,1160.6674,6491.4551,1148.1674,6478.9551" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1148.1674" y="6398.8541">33</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="480.9738" x="1217.2012" y="6375.209">Generate shared secret</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="470.5597" x="1230.1147" y="6422.4991">using admin public key</text><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="1257.5424" y1="6569.9951" y2="6569.9951"/><line style="stroke:#181818;stroke-width:3.125;" x1="1257.5424" x2="1257.5424" y1="6569.9951" y2="6610.6201"/><line style="stroke:#181818;stroke-width:3.125;" x1="1129.4174" x2="1257.5424" y1="6610.6201" y2="6610.6201"/><polygon fill="#181818" points="1160.6674,6598.1201,1129.4174,6610.6201,1160.6674,6623.1201,1148.1674,6610.6201" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1148.1674" y="6554.1641">34</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="397.8394" x="1217.2012" y="6554.1641">Decrypt unique CID</text><polygon fill="#181818" points="2208.5938,6736.4502,2239.8438,6748.9502,2208.5938,6761.4502,2221.0938,6748.9502" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="2227.3438" y1="6748.9502" y2="6748.9502"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1148.1674" y="6709.4742">35</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="693.2632" x="1217.2012" y="6685.8292">Download encrypted SSH key pair</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="413.5498" x="1230.1147" y="6733.1192">using decrypted CID</text><polygon fill="#181818" points="1160.6674,6827.4902,1129.4174,6839.9902,1160.6674,6852.4902,1148.1674,6839.9902" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="1141.9174" x2="2242.9688" y1="6839.9902" y2="6839.9902"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1179.4174" y="6824.1592">36</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="479.0894" x="1248.4512" y="6824.1592">Encrypted SSH key pair</text><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="1257.5424" y1="6931.0303" y2="6931.0303"/><line style="stroke:#181818;stroke-width:3.125;" x1="1257.5424" x2="1257.5424" y1="6931.0303" y2="6971.6553"/><line style="stroke:#181818;stroke-width:3.125;" x1="1129.4174" x2="1257.5424" y1="6971.6553" y2="6971.6553"/><polygon fill="#181818" points="1160.6674,6959.1553,1129.4174,6971.6553,1160.6674,6984.1553,1148.1674,6971.6553" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1148.1674" y="6915.1993">37</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="433.168" x="1217.2012" y="6915.1993">Decrypt SSH key pair</text><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="1257.5424" y1="7204.5654" y2="7204.5654"/><line style="stroke:#181818;stroke-width:3.125;" x1="1257.5424" x2="1257.5424" y1="7204.5654" y2="7245.1904"/><line style="stroke:#181818;stroke-width:3.125;" x1="1129.4174" x2="1257.5424" y1="7245.1904" y2="7245.1904"/><polygon fill="#181818" points="1160.6674,7232.6904,1129.4174,7245.1904,1160.6674,7257.6904,1148.1674,7245.1904" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1148.1674" y="7117.7994">38</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="262.2772" x="1217.2012" y="7046.8643">Validate that</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="478.4546" x="1230.1147" y="7094.1544">decrypted SSH key pair</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="285.1089" x="1230.1147" y="7141.4444">matches hash</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="408.2535" x="1230.1147" y="7188.7344">from smart contract</text><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="1257.5424" y1="7383.5205" y2="7383.5205"/><line style="stroke:#181818;stroke-width:3.125;" x1="1257.5424" x2="1257.5424" y1="7383.5205" y2="7424.1455"/><line style="stroke:#181818;stroke-width:3.125;" x1="1129.4174" x2="1257.5424" y1="7424.1455" y2="7424.1455"/><polygon fill="#181818" points="1160.6674,7411.6455,1129.4174,7424.1455,1160.6674,7436.6455,1148.1674,7424.1455" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1148.1674" y="7344.0445">39</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="391.214" x="1217.2012" y="7320.3995">Verify SSH key pair</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="455.4642" x="1230.1147" y="7367.6895">signature with SSH CA</text><line style="stroke:#181818;stroke-width:3.125;" x1="1126.2924" x2="1257.5424" y1="7562.4756" y2="7562.4756"/><line style="stroke:#181818;stroke-width:3.125;" x1="1257.5424" x2="1257.5424" y1="7562.4756" y2="7603.1006"/><line style="stroke:#181818;stroke-width:3.125;" x1="1129.4174" x2="1257.5424" y1="7603.1006" y2="7603.1006"/><polygon fill="#181818" points="1160.6674,7590.6006,1129.4174,7603.1006,1160.6674,7615.6006,1148.1674,7603.1006" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1148.1674" y="7522.9996">40</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="483.6716" x="1217.2012" y="7499.3546">Apply new SSH key pair</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="359.9915" x="1230.1147" y="7546.6446">with SSH daemon</text><text fill="#000000" font-family="sans-serif" font-size="34.375" lengthAdjust="spacing" textLength="343.1793" x="1324.7818" y="7703.7582">Some time (ex: 1m)</text><polygon fill="#181818" points="2208.5938,7809.1553,2239.8438,7821.6553,2208.5938,7834.1553,2221.0938,7821.6553" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="2227.3438" y1="7821.6553" y2="7821.6553"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="7805.8243">41</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="539.0152" x="476.6342" y="7805.8243">Delete data and unpin CID</text><path d="M400,7862.2803 L400,7940.4053 L1296.875,7940.4053 L1296.875,7893.5303 L1265.625,7862.2803 L400,7862.2803 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M1265.625,7862.2803 L1265.625,7893.5303 L1296.875,7893.5303 L1265.625,7862.2803 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="831.5033" x="418.75" y="7915.6143">Encrypted key pair is no longer available</text><rect fill="#EEEEEE" height="9.375" style="stroke:#EEEEEE;stroke-width:3.125;" width="2858.6166" x="0" y="8020.7153"/><line style="stroke:#000000;stroke-width:3.125;" x1="0" x2="2858.6166" y1="8020.7153" y2="8020.7153"/><line style="stroke:#000000;stroke-width:3.125;" x1="0" x2="2858.6166" y1="8030.0903" y2="8030.0903"/><rect fill="#EEEEEE" height="72.29" style="stroke:#000000;stroke-width:6.25;" width="468.8843" x="1194.8662" y="7987.6953"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="410.9909" x="1213.6162" y="8037.9044">SSH keys rotation</text><path d="M300,8106.8604 L300,8231.8604 L1812.5,8231.8604 L1812.5,8138.1104 L1781.25,8106.8604 L300,8106.8604 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><path d="M1781.25,8106.8604 L1781.25,8138.1104 L1812.5,8138.1104 L1781.25,8106.8604 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.5625;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="945.8603" x="570.3468" y="8160.1944">In this group we have an example with server,</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="777.8656" x="570.3468" y="8207.4844">but for client same steps should work.</text><polygon fill="#181818" points="2569.5175,8301.8555,2600.7675,8314.3555,2569.5175,8326.8555,2582.0175,8314.3555" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="385.7254" x2="2588.2675" y1="8314.3555" y2="8314.3555"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="407.6004" y="8298.5245">42</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="595.8862" x="476.6342" y="8298.5245">Revoke existing SSH key pair</text><polygon fill="#181818" points="1764.8193,8392.8955,1733.5693,8405.3955,1764.8193,8417.8955,1752.3193,8405.3955" style="stroke:#181818;stroke-width:3.125;"/><line style="stroke:#181818;stroke-width:3.125;" x1="1746.0693" x2="2603.8925" y1="8405.3955" y2="8405.3955"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1783.5693" y="8389.5645">43</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="479.4861" x="1852.6031" y="8389.5645">Notify about revocation</text><line style="stroke:#181818;stroke-width:3.125;" x1="1730.4443" x2="1861.6943" y1="8543.7256" y2="8543.7256"/><line style="stroke:#181818;stroke-width:3.125;" x1="1861.6943" x2="1861.6943" y1="8543.7256" y2="8584.3506"/><line style="stroke:#181818;stroke-width:3.125;" x1="1733.5693" x2="1861.6943" y1="8584.3506" y2="8584.3506"/><polygon fill="#181818" points="1764.8193,8571.8506,1733.5693,8584.3506,1764.8193,8596.8506,1752.3193,8584.3506" style="stroke:#181818;stroke-width:3.125;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="56.5338" x="1752.3193" y="8504.2496">44</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="298.2803" x="1821.3531" y="8480.6046">Apply changes</text><text fill="#000000" font-family="sans-serif" font-size="40.625" lengthAdjust="spacing" textLength="359.9915" x="1834.2667" y="8527.8946">with SSH daemon</text><rect fill="transparent" height="209.4971" style="stroke:#000000;stroke-width:4.6875;" width="690.3687" x="1627.4597" y="8609.3506"/><path d="M1627.4597,8609.3506 L1830.5847,8609.3506 L1830.5847,8631.2256 L1799.3347,8662.4756 L1627.4597,8662.4756 L1627.4597,8609.3506 " fill="#EEEEEE" style="stroke:#000000;stroke-width:6.25;"/><text fill="#000000" font-family="sans-serif" font-size="40.625" font-weight="bold" lengthAdjust="spacing" textLength="65.2618" x="1668.0847" y="8653.3096">ref</text><text fill="#000000" font-family="sans-serif" font-size="37.5" lengthAdjust="spacing" textLength="665.3687" x="1639.9597" y="8709.7839">To have new key pair on the server</text><text fill="#000000" font-family="sans-serif" font-size="37.5" lengthAdjust="spacing" textLength="618.5852" x="1663.3514" y="8753.4363">it is required to go through steps</text><text fill="#000000" font-family="sans-serif" font-size="37.5" lengthAdjust="spacing" textLength="420.0623" x="1762.6129" y="8797.0886">from previous section.</text><!--SRC=[fLTBRzms4BxpLn2vj0LYEKLl1bp0zQQ9KRG8iabpyOKhZLQ4AL8XgLtll-yCIRrMajTeWC2Hn7byyysBwvwaReGLDIyQoNzxzuw9rXlTrZkmZE69bxbiXFRyhgYbvi9nGG-Jetib0V_3ipmyJGwtO0zWwT25fydXmwS_jtGacz9D3jviQtpZzqPxAtB_9XXFBupTtg9PtpRScT8VXGNkF3IEtzuofeq7Re9B0lesGVfMWOvVkDJE2wNSe6rqGiw5BX9EBZq-USTt9_9SoZsJ-6QEcZVjJicSFy4futVAcLxK1T0TJdHNM70kOsnh1cUvqDpRrdaU0swLi3DDX171ZdmnmAyK7ej7Lxydr3Vy8OR4Dv_-UkWz3M8neZKn9XIc5zFEQrC0uuGB_t8-K1dzl4qPfBClbNHy3ngiy50GFbIJo9eZDMv1XUz7wIk-tNxCWj8tu1hmA_A5tex6FaM1XUZnN6eFuJt8X62ov5ludzp4Psse243ZFoyFm7s5BAFVNiXDL8_LgGClCVckCgqg-0vuOqsEAKECr0Sr7kT8s8aW1VqaYM4GBGe4-YhW87E8zliKqKkggL6UFYJ2UbXdSY786onkD3DaFbfMBbfDvJbAwxBLGMxLAdvWR9pds39zch5iOmqzQNDqAL0tik5GYBBLdP3SGk6EUA4m-Dz2jq9rvRPUPW_OALHdkK2bQ9QwPmz-6aTfJPqmK2-d1e-vDHXLwKC_Ju0CPVxQDCswxiC4nnZ5nEwGWKy_cD9PGrz0qDbTGK3f3oM0y_GFQqI1FEFClUCvu60giVGH0CtKtc-oqgFJS0nTXZezq86crCzOUTGc8zbHybZCGj_x8th_CGW2MszdMh-YdHWSQtVKl4QROa_-XnheKHEvoufZZoF0dt4dMRskCwkpkwR1sJB8F-f-OF92G6rq5-5G8Vy3NqV91NppAdmDlbdzTE8q7cXvndfOMisfpxiktrk3A_q8lA9omJw7Pr4t2gBFD1lO3jDPObCdj4xKtVPFivdMocXNhdaDYti79IqENu7hh4IuoLPZeQ6T7UlRZSrUx8bvGtHpMEv34jHfMA2Fuu79MoVrFd4-KxyNYkuCddXo5JVbuypQu7ir-j5OdrzzHWC-O_qIYACtHUagv8KKSejb679DMPdPojZN4Cn6bgM4gu-WL8rs220yvxYbzx1qiJadTU8E0uuC9M_ZSN9kuRtExQdnYI7KJcmlPuZkeJGaFSx6e8S-9vA1JWMbJwALzusxkRukJEuo-fHvoAjhRByS6k_emIF4gtGLHD3NZCJ6CpcrPQlbznPl4y8BVl-mMOq4pte29hImrT6BbwcpAzOG7fgB3TPVfwYis0i3kSlnPBBssk8Wf18xgQJ7TBomMvTJUdvvMB2mWKX48eou6eHYMZPuJLSua5RIs7ihO4J3a9ZEq_lb8dW1qqHkBlQlKBAWuF5-IZ4F_i_WuSqpnw4KSe6lOR5FKxXa7IpbvyoKmt4ZiC9WcDquLIujev61yv7FiYp3go7ENI_npy_mVCD_hN_X-9cTjz865FXKr3GKMjtWCP4TEidAVUNF2dpsQu8hWrEYhom5yGTWjsAiyV6czyCh9WeFAoPnT7d5BFJTPpYO9q3xqlbkc0-5SUc-Ob4x3r6njQqSPwTRoe-5CdAGelzYOhoKsvvQGvH09uA_o90U2zzRIKs90sDly1pfsbSnTXPg41VYGPgMVipd12-mmFu3]--></g></svg>